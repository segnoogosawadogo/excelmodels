<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ExcelModel - Mod√®les Excel Professionnels</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìä</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root {
            --primary: #1a73e8;
            --primary-dark: #1557b0;
            --primary-light: #e8f0fe;
            --secondary: #34a853;
            --accent: #ea4335;
            --orange: #f9ab00;
            --purple: #9334e6;
            --gray-900: #202124;
            --gray-800: #3c4043;
            --gray-700: #5f6368;
            --gray-600: #80868b;
            --gray-500: #9aa0a6;
            --gray-400: #bdc1c6;
            --gray-300: #dadce0;
            --gray-200: #e8eaed;
            --gray-100: #f1f3f4;
            --gray-50: #f8f9fa;
            --white: #ffffff;
            --shadow-sm: 0 1px 2px rgba(60,64,67,0.1);
            --shadow: 0 1px 3px rgba(60,64,67,0.15), 0 1px 2px rgba(60,64,67,0.1);
            --shadow-md: 0 4px 8px rgba(60,64,67,0.15), 0 1px 3px rgba(60,64,67,0.1);
            --shadow-lg: 0 8px 16px rgba(60,64,67,0.15), 0 3px 6px rgba(60,64,67,0.1);
            --radius: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background: var(--white); color: var(--gray-800); line-height: 1.6; }
        
        .container { max-width: 1320px; margin: 0 auto; padding: 0 24px; }
        
        /* Buttons */
        .btn { display: inline-flex; align-items: center; justify-content: center; gap: 8px; padding: 12px 24px; border-radius: var(--radius); font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s; text-decoration: none; border: none; font-family: inherit; }
        .btn-primary { background: var(--primary); color: var(--white); }
        .btn-primary:hover { background: var(--primary-dark); box-shadow: var(--shadow-md); }
        .btn-secondary { background: var(--secondary); color: var(--white); }
        .btn-secondary:hover { background: #2d9249; }
        .btn-outline { background: var(--white); color: var(--gray-700); border: 1px solid var(--gray-300); }
        .btn-outline:hover { background: var(--gray-50); border-color: var(--gray-400); }
        .btn-ghost { background: transparent; color: var(--gray-700); }
        .btn-ghost:hover { background: var(--gray-100); }
        .btn-danger { background: var(--accent); color: var(--white); }
        .btn-sm { padding: 8px 16px; font-size: 13px; }
        .btn-lg { padding: 14px 32px; font-size: 16px; }
        .btn-block { width: 100%; }
        
        /* Forms */
        .form-group { margin-bottom: 20px; }
        .form-label { display: block; margin-bottom: 8px; font-weight: 500; font-size: 14px; color: var(--gray-700); }
        .form-input, .form-textarea, .form-select { width: 100%; padding: 12px 16px; background: var(--white); border: 1px solid var(--gray-300); border-radius: var(--radius); font-size: 14px; font-family: inherit; transition: all 0.2s; }
        .form-input:focus, .form-textarea:focus, .form-select:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(26,115,232,0.15); }
        .form-textarea { min-height: 100px; resize: vertical; }
        .form-checkbox { display: flex; align-items: center; gap: 10px; cursor: pointer; font-size: 14px; }
        .form-checkbox input { width: 18px; height: 18px; accent-color: var(--primary); }

        /* File Upload */
        .file-upload { border: 2px dashed var(--gray-300); border-radius: var(--radius-lg); padding: 32px; text-align: center; cursor: pointer; transition: all 0.2s; background: var(--gray-50); }
        .file-upload:hover { border-color: var(--primary); background: var(--primary-light); }
        .file-upload.dragover { border-color: var(--primary); background: var(--primary-light); }
        .file-upload-icon { font-size: 40px; margin-bottom: 12px; }
        .file-upload-text { font-size: 14px; color: var(--gray-600); }
        .file-upload-text strong { color: var(--primary); }
        .file-upload input[type="file"] { display: none; }
        .file-preview { margin-top: 16px; padding: 16px; background: var(--white); border: 1px solid var(--gray-200); border-radius: var(--radius); display: flex; align-items: center; gap: 16px; }
        .file-preview img { width: 80px; height: 60px; object-fit: cover; border-radius: var(--radius); }
        .file-preview-info { flex: 1; text-align: left; }
        .file-preview-name { font-weight: 600; font-size: 14px; color: var(--gray-800); }
        .file-preview-size { font-size: 12px; color: var(--gray-500); margin-top: 2px; }
        .file-preview-remove { background: none; border: none; color: var(--accent); cursor: pointer; font-size: 20px; padding: 4px; }

        /* Icon Picker */
        .icon-picker { position: relative; }
        .icon-picker-btn { width: 100%; padding: 12px 16px; background: var(--white); border: 1px solid var(--gray-300); border-radius: var(--radius); font-size: 24px; cursor: pointer; text-align: left; display: flex; align-items: center; gap: 12px; }
        .icon-picker-btn span { font-size: 14px; color: var(--gray-500); }
        .icon-picker-dropdown { position: absolute; top: 100%; left: 0; right: 0; background: var(--white); border: 1px solid var(--gray-200); border-radius: var(--radius); box-shadow: var(--shadow-lg); padding: 16px; display: none; z-index: 100; max-height: 240px; overflow-y: auto; }
        .icon-picker-dropdown.show { display: block; }
        .icon-picker-grid { display: grid; grid-template-columns: repeat(8, 1fr); gap: 8px; }
        .icon-picker-item { font-size: 24px; padding: 10px; text-align: center; cursor: pointer; border-radius: var(--radius); transition: background 0.15s; }
        .icon-picker-item:hover { background: var(--gray-100); }

        /* Header */
        .header { background: var(--white); border-bottom: 1px solid var(--gray-200); position: sticky; top: 0; z-index: 1000; }
        .header-top { background: var(--primary); color: var(--white); padding: 8px 0; font-size: 13px; }
        .header-top-content { display: flex; justify-content: space-between; align-items: center; }
        .header-top a { color: var(--white); text-decoration: none; opacity: 0.9; }
        .header-top a:hover { opacity: 1; }
        .nav-container { display: flex; align-items: center; justify-content: space-between; height: 70px; }
        .logo { display: flex; align-items: center; gap: 12px; text-decoration: none; cursor: pointer; }
        .logo-icon { width: 44px; height: 44px; background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: var(--white); font-weight: 800; font-size: 16px; }
        .logo-text { font-size: 24px; font-weight: 800; color: var(--gray-900); }
        .logo-text span { color: var(--primary); }
        .nav-links { display: flex; align-items: center; gap: 4px; }
        .nav-link { padding: 10px 18px; color: var(--gray-700); font-weight: 500; font-size: 15px; border-radius: var(--radius); transition: all 0.2s; cursor: pointer; text-decoration: none; }
        .nav-link:hover { color: var(--primary); background: var(--primary-light); }
        .nav-actions { display: flex; align-items: center; gap: 12px; }
        .nav-user { display: flex; align-items: center; gap: 10px; padding: 6px 14px; background: var(--gray-100); border-radius: 50px; cursor: pointer; }
        .nav-user-avatar { width: 34px; height: 34px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--white); font-weight: 600; font-size: 14px; }
        .nav-dropdown { position: relative; }
        .nav-dropdown-menu { position: absolute; top: calc(100% + 8px); right: 0; background: var(--white); border: 1px solid var(--gray-200); border-radius: var(--radius-lg); min-width: 200px; box-shadow: var(--shadow-lg); opacity: 0; visibility: hidden; transform: translateY(-10px); transition: all 0.2s; }
        .nav-dropdown:hover .nav-dropdown-menu { opacity: 1; visibility: visible; transform: translateY(0); }
        .nav-dropdown-item { display: flex; align-items: center; gap: 12px; padding: 12px 18px; color: var(--gray-700); font-size: 14px; cursor: pointer; transition: all 0.15s; }
        .nav-dropdown-item:hover { background: var(--gray-50); color: var(--primary); }
        .nav-dropdown-divider { height: 1px; background: var(--gray-200); margin: 4px 0; }
        .mobile-menu-btn { display: none; background: none; border: none; font-size: 26px; cursor: pointer; color: var(--gray-700); }

        .page { display: none; }
        .page.active { display: block; }

        /* Hero */
        .hero { background: linear-gradient(135deg, #1a73e8 0%, #34a853 100%); padding: 80px 0; color: var(--white); }
        .hero-content { max-width: 700px; }
        .hero h1 { font-size: 48px; font-weight: 800; line-height: 1.15; margin-bottom: 20px; }
        .hero-subtitle { font-size: 18px; opacity: 0.95; margin-bottom: 32px; line-height: 1.7; }
        .hero-actions { display: flex; gap: 16px; flex-wrap: wrap; }
        .hero .btn-primary { background: var(--white); color: var(--primary); }
        .hero .btn-primary:hover { background: var(--gray-100); }
        .hero .btn-outline { border-color: rgba(255,255,255,0.5); color: var(--white); }
        .hero .btn-outline:hover { background: rgba(255,255,255,0.1); border-color: var(--white); }
        .hero-stats { display: flex; gap: 48px; margin-top: 48px; }
        .hero-stat-value { font-size: 36px; font-weight: 800; }
        .hero-stat-label { font-size: 14px; opacity: 0.85; }

        /* Search */
        .search-section { background: var(--white); padding: 40px 0; border-bottom: 1px solid var(--gray-200); }
        .search-box { display: flex; max-width: 700px; margin: 0 auto; background: var(--white); border: 2px solid var(--gray-200); border-radius: 50px; overflow: hidden; transition: border-color 0.2s; }
        .search-box:focus-within { border-color: var(--primary); }
        .search-box input { flex: 1; border: none; outline: none; font-size: 16px; padding: 16px 24px; background: transparent; }
        .search-btn { background: var(--primary); color: var(--white); border: none; padding: 16px 32px; font-weight: 600; font-size: 15px; cursor: pointer; margin: 4px; border-radius: 50px; }
        .search-btn:hover { background: var(--primary-dark); }
        .search-tags { display: flex; justify-content: center; gap: 10px; margin-top: 20px; flex-wrap: wrap; }
        .search-tag { padding: 8px 16px; background: var(--gray-100); border-radius: 50px; font-size: 13px; color: var(--gray-700); cursor: pointer; transition: all 0.2s; font-weight: 500; }
        .search-tag:hover { background: var(--primary-light); color: var(--primary); }

        /* Sections */
        .section { padding: 64px 0; }
        .section-gray { background: var(--gray-50); }
        .section-header { margin-bottom: 40px; }
        .section-title { font-size: 32px; font-weight: 700; color: var(--gray-900); margin-bottom: 8px; }
        .section-subtitle { font-size: 16px; color: var(--gray-600); }
        .section-header-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; flex-wrap: wrap; gap: 16px; }

        /* Categories */
        .categories-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 16px; }
        .category-card { background: var(--white); border: 1px solid var(--gray-200); border-radius: var(--radius-lg); padding: 24px 20px; text-align: center; cursor: pointer; transition: all 0.2s; }
        .category-card:hover { border-color: var(--primary); box-shadow: var(--shadow-md); transform: translateY(-2px); }
        .category-icon { font-size: 40px; margin-bottom: 12px; }
        .category-name { font-weight: 600; font-size: 15px; color: var(--gray-800); margin-bottom: 4px; }
        .category-count { font-size: 13px; color: var(--gray-500); }

        /* Template Cards - SlideModel Style */
        .templates-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 24px; }
        .template-card { background: var(--white); border: 1px solid var(--gray-200); border-radius: var(--radius-lg); overflow: hidden; cursor: pointer; transition: all 0.25s; }
        .template-card:hover { box-shadow: var(--shadow-lg); transform: translateY(-4px); }
        .template-preview { height: 200px; background: var(--gray-100); position: relative; overflow: hidden; }
        .template-preview img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s; }
        .template-card:hover .template-preview img { transform: scale(1.05); }
        .template-badge { position: absolute; top: 12px; right: 12px; padding: 6px 12px; border-radius: 6px; font-size: 11px; font-weight: 700; text-transform: uppercase; }
        .template-badge.new { background: var(--secondary); color: var(--white); }
        .template-badge.popular { background: var(--orange); color: var(--white); }
        .template-badge.premium { background: var(--purple); color: var(--white); }
        .template-badge.free { background: var(--primary); color: var(--white); }
        .template-info { padding: 20px; }
        .template-title { font-size: 17px; font-weight: 600; color: var(--gray-900); margin-bottom: 10px; line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .template-desc { font-size: 14px; color: var(--gray-600); margin-bottom: 16px; line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; min-height: 42px; }
        .template-footer { display: flex; align-items: center; gap: 12px; padding-top: 16px; border-top: 1px solid var(--gray-100); }
        .template-format { display: flex; align-items: center; gap: 6px; font-size: 13px; color: var(--gray-600); }
        .template-format-icon { width: 24px; height: 24px; background: #217346; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: var(--white); font-size: 10px; font-weight: 700; }
        .template-category-tag { font-size: 13px; color: var(--primary); font-weight: 500; }

        /* Pagination */
        .pagination { display: flex; align-items: center; justify-content: center; gap: 8px; margin-top: 48px; padding-top: 32px; border-top: 1px solid var(--gray-200); }
        .pagination-btn { padding: 12px 20px; background: var(--white); border: 1px solid var(--gray-300); border-radius: var(--radius); font-size: 14px; font-weight: 500; cursor: pointer; font-family: inherit; transition: all 0.2s; }
        .pagination-btn:hover:not(:disabled) { background: var(--gray-50); border-color: var(--primary); }
        .pagination-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .pagination-info { padding: 12px 24px; font-size: 14px; color: var(--gray-600); font-weight: 500; }

        /* Filters */
        .filters { display: flex; gap: 8px; flex-wrap: wrap; }
        .filter-btn { padding: 10px 20px; background: var(--white); border: 1px solid var(--gray-300); border-radius: 50px; font-size: 14px; font-weight: 500; cursor: pointer; font-family: inherit; transition: all 0.2s; }
        .filter-btn:hover, .filter-btn.active { background: var(--primary); border-color: var(--primary); color: var(--white); }

        /* Template Detail - SlideModel Style */
        .template-detail { padding: 48px 0; }
        .breadcrumb { display: flex; align-items: center; gap: 8px; font-size: 14px; color: var(--gray-600); margin-bottom: 24px; flex-wrap: wrap; }
        .breadcrumb a { color: var(--primary); text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb-sep { color: var(--gray-400); }
        .template-detail-grid { display: grid; grid-template-columns: 1fr 380px; gap: 48px; }
        .template-detail-title { font-size: 28px; font-weight: 700; color: var(--gray-900); margin-bottom: 24px; }
        .template-main-image { background: var(--gray-100); border-radius: var(--radius-lg); overflow: hidden; position: relative; margin-bottom: 16px; }
        .template-main-image img { width: 100%; height: auto; display: block; }
        .template-main-image-placeholder { height: 400px; display: flex; align-items: center; justify-content: center; font-size: 80px; color: var(--gray-300); }
        .image-nav { position: absolute; top: 50%; transform: translateY(-50%); width: 48px; height: 48px; background: var(--white); border: none; border-radius: 50%; box-shadow: var(--shadow-md); cursor: pointer; font-size: 20px; display: flex; align-items: center; justify-content: center; }
        .image-nav.prev { left: 16px; }
        .image-nav.next { right: 16px; }
        .image-nav:hover { background: var(--gray-50); }
        .template-thumbnails { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 12px; }
        .template-thumbnail { border: 2px solid transparent; border-radius: var(--radius); overflow: hidden; cursor: pointer; opacity: 0.7; transition: all 0.2s; }
        .template-thumbnail:hover, .template-thumbnail.active { border-color: var(--primary); opacity: 1; }
        .template-thumbnail img { width: 100%; height: 70px; object-fit: cover; display: block; }
        .template-detail-video { margin-top: 32px; }
        .template-detail-video iframe { width: 100%; height: 400px; border-radius: var(--radius-lg); border: none; }
        .template-detail-description { margin-top: 32px; }
        .template-detail-description h3 { font-size: 18px; font-weight: 600; margin-bottom: 16px; color: var(--gray-900); }
        .template-detail-description p { color: var(--gray-600); line-height: 1.8; }

        /* Sidebar */
        .sidebar-card { background: var(--white); border: 1px solid var(--gray-200); border-radius: var(--radius-lg); overflow: hidden; position: sticky; top: 100px; }
        .sidebar-login-msg { display: flex; align-items: center; gap: 8px; padding: 12px 20px; background: var(--gray-50); font-size: 13px; color: var(--gray-600); border-bottom: 1px solid var(--gray-200); }
        .sidebar-actions { padding: 24px; }
        .sidebar-price { text-align: center; margin-bottom: 20px; }
        .sidebar-price-value { font-size: 32px; font-weight: 800; color: var(--gray-900); }
        .sidebar-price-value.free { color: var(--secondary); }
        .sidebar-btns { display: flex; flex-direction: column; gap: 12px; }
        .sidebar-details { padding: 24px; border-top: 1px solid var(--gray-200); }
        .sidebar-details-title { font-size: 16px; font-weight: 600; margin-bottom: 16px; color: var(--gray-900); }
        .sidebar-detail-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid var(--gray-100); font-size: 14px; }
        .sidebar-detail-row:last-child { border-bottom: none; }
        .sidebar-detail-label { color: var(--gray-600); }
        .sidebar-detail-value { color: var(--gray-900); font-weight: 500; }
        .sidebar-detail-value a { color: var(--primary); text-decoration: none; }
        .sidebar-rating { display: flex; gap: 2px; }
        .star { color: var(--orange); }
        .star.empty { color: var(--gray-300); }

        /* Auth Pages */
        .auth-page { min-height: calc(100vh - 150px); display: flex; align-items: center; justify-content: center; padding: 48px 24px; background: var(--gray-50); }
        .auth-card { background: var(--white); border: 1px solid var(--gray-200); border-radius: var(--radius-xl); padding: 48px; width: 100%; max-width: 440px; box-shadow: var(--shadow-lg); }
        .auth-header { text-align: center; margin-bottom: 32px; }
        .auth-title { font-size: 26px; font-weight: 700; margin-bottom: 8px; color: var(--gray-900); }
        .auth-subtitle { color: var(--gray-600); font-size: 15px; }
        .auth-footer { text-align: center; margin-top: 24px; font-size: 14px; color: var(--gray-600); }
        .auth-footer a { color: var(--primary); font-weight: 500; text-decoration: none; }

        /* Admin */
        .admin-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; flex-wrap: wrap; gap: 16px; }
        .admin-tabs { display: flex; gap: 8px; margin-bottom: 24px; border-bottom: 1px solid var(--gray-200); padding-bottom: 16px; }
        .admin-tab { padding: 12px 24px; background: transparent; border: none; font-size: 14px; font-weight: 500; color: var(--gray-600); cursor: pointer; border-radius: var(--radius); font-family: inherit; transition: all 0.2s; }
        .admin-tab:hover { background: var(--gray-100); }
        .admin-tab.active { color: var(--primary); background: var(--primary-light); }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 32px; }
        .stat-card { background: var(--white); border: 1px solid var(--gray-200); border-radius: var(--radius-lg); padding: 24px; }
        .stat-card-icon { width: 52px; height: 52px; border-radius: var(--radius); display: flex; align-items: center; justify-content: center; font-size: 26px; margin-bottom: 16px; }
        .stat-card-icon.blue { background: var(--primary-light); }
        .stat-card-icon.green { background: #e6f4ea; }
        .stat-card-icon.orange { background: #fef7e0; }
        .stat-card-icon.purple { background: #f3e8ff; }
        .stat-card-value { font-size: 32px; font-weight: 800; color: var(--gray-900); }
        .stat-card-label { font-size: 14px; color: var(--gray-600); margin-top: 4px; }

        /* Table */
        .table-container { background: var(--white); border: 1px solid var(--gray-200); border-radius: var(--radius-lg); overflow: hidden; }
        .table { width: 100%; border-collapse: collapse; }
        .table th, .table td { padding: 16px 20px; text-align: left; border-bottom: 1px solid var(--gray-200); }
        .table th { background: var(--gray-50); font-weight: 600; font-size: 13px; color: var(--gray-600); text-transform: uppercase; letter-spacing: 0.5px; }
        .table tr:last-child td { border-bottom: none; }
        .table tr:hover td { background: var(--gray-50); }
        .table-actions { display: flex; gap: 8px; }
        .table-badge { padding: 5px 12px; border-radius: 50px; font-size: 12px; font-weight: 600; }
        .table-badge.success { background: #e6f4ea; color: var(--secondary); }
        .table-badge.danger { background: #fce8e6; color: var(--accent); }

        /* Modals */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 2000; display: flex; align-items: center; justify-content: center; padding: 24px; opacity: 0; visibility: hidden; transition: all 0.2s; }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        .modal { background: var(--white); border-radius: var(--radius-xl); width: 100%; max-width: 640px; max-height: 90vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; padding: 24px; border-bottom: 1px solid var(--gray-200); }
        .modal-title { font-size: 20px; font-weight: 700; color: var(--gray-900); }
        .modal-close { background: none; border: none; font-size: 28px; color: var(--gray-400); cursor: pointer; line-height: 1; }
        .modal-close:hover { color: var(--gray-600); }
        .modal-body { padding: 24px; }
        .modal-footer { display: flex; justify-content: flex-end; gap: 12px; padding: 20px 24px; border-top: 1px solid var(--gray-200); }

        /* Toast */
        .toast-container { position: fixed; top: 100px; right: 24px; z-index: 3000; display: flex; flex-direction: column; gap: 12px; }
        .toast { background: var(--white); border: 1px solid var(--gray-200); border-radius: var(--radius-lg); padding: 16px 20px; display: flex; align-items: center; gap: 12px; min-width: 320px; box-shadow: var(--shadow-lg); transform: translateX(120%); transition: transform 0.3s ease; }
        .toast.show { transform: translateX(0); }
        .toast.success { border-left: 4px solid var(--secondary); }
        .toast.error { border-left: 4px solid var(--accent); }
        .toast.warning { border-left: 4px solid var(--orange); }
        .toast-icon { font-size: 20px; }
        .toast-message { flex: 1; font-size: 14px; color: var(--gray-800); }
        .toast-close { background: none; border: none; color: var(--gray-400); cursor: pointer; font-size: 18px; }

        /* Footer */
        .footer { background: var(--gray-900); color: var(--gray-400); padding: 64px 0 32px; margin-top: 80px; }
        .footer-grid { display: grid; grid-template-columns: 2fr repeat(3, 1fr); gap: 48px; margin-bottom: 48px; }
        .footer-brand .logo-text { color: var(--white); }
        .footer-desc { font-size: 14px; line-height: 1.8; margin-top: 16px; }
        .footer-title { font-weight: 600; font-size: 15px; color: var(--white); margin-bottom: 20px; }
        .footer-links { list-style: none; }
        .footer-links li { margin-bottom: 12px; }
        .footer-links a { color: var(--gray-400); text-decoration: none; font-size: 14px; transition: color 0.2s; }
        .footer-links a:hover { color: var(--white); }
        .footer-bottom { padding-top: 32px; border-top: 1px solid var(--gray-700); text-align: center; }
        .footer-copy { font-size: 14px; }

        /* WhatsApp Float */
        .whatsapp-float { position: fixed; bottom: 24px; right: 24px; z-index: 1000; display: flex; align-items: center; gap: 10px; background: #25d366; color: var(--white); padding: 14px 24px; border-radius: 50px; text-decoration: none; font-weight: 600; font-size: 14px; box-shadow: var(--shadow-lg); transition: all 0.2s; }
        .whatsapp-float:hover { transform: translateY(-3px); box-shadow: 0 8px 24px rgba(37,211,102,0.4); }
        .whatsapp-float svg { width: 22px; height: 22px; fill: currentColor; }

        /* Responsive */
        @media (max-width: 1024px) {
            .template-detail-grid { grid-template-columns: 1fr; }
            .sidebar-card { position: static; }
            .footer-grid { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 768px) {
            .nav-links { display: none; }
            .mobile-menu-btn { display: block; }
            .hero h1 { font-size: 32px; }
            .hero-stats { flex-direction: column; gap: 20px; }
            .section-title { font-size: 26px; }
            .templates-grid { grid-template-columns: 1fr; }
            .footer-grid { grid-template-columns: 1fr; }
            .header-top { display: none; }
        }
    </style>
</head>
<body>
    <div class="toast-container" id="toastContainer"></div>
    
    <a href="https://wa.me/221773684203" target="_blank" class="whatsapp-float">
        <svg viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
        Besoin d'aide ?
    </a>

    <header class="header">
        <div class="header-top">
            <div class="container">
                <div class="header-top-content">
                    <span>üìß sawadgsalif@gmail.com | üì± +221 77 368 42 03</span>
                    <a href="https://wa.me/221773684203">Support WhatsApp ‚Üí</a>
                </div>
            </div>
        </div>
        <nav class="container">
            <div class="nav-container">
                <div class="logo" onclick="App.navigate('home')">
                    <div class="logo-icon">XL</div>
                    <span class="logo-text">Excel<span>Model</span></span>
                </div>
                <div class="nav-links">
                    <span class="nav-link" onclick="App.navigate('home')">Accueil</span>
                    <span class="nav-link" onclick="App.navigate('templates')">Mod√®les</span>
                    <span class="nav-link" onclick="App.navigate('pricing')">Tarifs</span>
                </div>
                <div class="nav-actions" id="navActions"></div>
                <button class="mobile-menu-btn" onclick="App.toggleMobileMenu()">‚ò∞</button>
            </div>
        </nav>
    </header>

    <main id="app">
        <!-- HOME -->
        <div class="page active" id="page-home">
            <section class="hero">
                <div class="container">
                    <div class="hero-content">
                        <h1>Mod√®les Excel Professionnels pour votre Business</h1>
                        <p class="hero-subtitle">T√©l√©chargez des mod√®les Excel pr√™ts √† l'emploi. Tableaux de bord, finances, RH, gestion de projet. 100% √©ditables et adapt√©s aux entreprises africaines.</p>
                        <div class="hero-actions">
                            <button class="btn btn-primary btn-lg" onclick="App.navigate('templates')">Explorer les Mod√®les</button>
                            <button class="btn btn-outline btn-lg" onclick="App.navigate('pricing')">Voir les Tarifs</button>
                        </div>
                        <div class="hero-stats">
                            <div class="hero-stat"><div class="hero-stat-value" id="statTemplates">0</div><div class="hero-stat-label">Mod√®les disponibles</div></div>
                            <div class="hero-stat"><div class="hero-stat-value">50K+</div><div class="hero-stat-label">T√©l√©chargements</div></div>
                            <div class="hero-stat"><div class="hero-stat-value">4.9‚òÖ</div><div class="hero-stat-label">Note moyenne</div></div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="search-section">
                <div class="container">
                    <div class="search-box">
                        <input type="text" id="searchInput" placeholder="Rechercher un mod√®le Excel..." onkeyup="if(event.key==='Enter')App.search()">
                        <button class="search-btn" onclick="App.search()">üîç Rechercher</button>
                    </div>
                    <div class="search-tags" id="searchTags"></div>
                </div>
            </section>

            <section class="section">
                <div class="container">
                    <div class="section-header">
                        <h2 class="section-title">Parcourir par Cat√©gorie</h2>
                        <p class="section-subtitle">Trouvez rapidement le mod√®le qui correspond √† vos besoins</p>
                    </div>
                    <div class="categories-grid" id="categoriesGrid"></div>
                </div>
            </section>

            <section class="section section-gray">
                <div class="container">
                    <div class="section-header-row">
                        <div>
                            <h2 class="section-title">Mod√®les Populaires</h2>
                            <p class="section-subtitle">Les mod√®les les plus t√©l√©charg√©s par nos utilisateurs</p>
                        </div>
                        <button class="btn btn-outline" onclick="App.navigate('templates')">Voir tous les mod√®les ‚Üí</button>
                    </div>
                    <div class="templates-grid" id="featuredTemplatesGrid"></div>
                </div>
            </section>
        </div>

        <!-- TEMPLATES LIST -->
        <div class="page" id="page-templates">
            <section class="section">
                <div class="container">
                    <div class="section-header-row">
                        <h2 class="section-title">Tous les Mod√®les Excel</h2>
                        <div class="filters" id="templatesFilters"></div>
                    </div>
                    <div class="templates-grid" id="allTemplatesGrid"></div>
                    <div class="pagination" id="pagination"></div>
                </div>
            </section>
        </div>

        <!-- TEMPLATE DETAIL -->
        <div class="page" id="page-template-detail">
            <section class="template-detail">
                <div class="container" id="templateDetail"></div>
            </section>
        </div>

        <!-- LOGIN -->
        <div class="page" id="page-login">
            <div class="auth-page">
                <div class="auth-card">
                    <div class="auth-header">
                        <h1 class="auth-title">Connexion</h1>
                        <p class="auth-subtitle">Acc√©dez √† votre compte ExcelModel</p>
                    </div>
                    <form onsubmit="App.login(event)">
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-input" id="loginEmail" required placeholder="votre@email.com">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Mot de passe</label>
                            <input type="password" class="form-input" id="loginPassword" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                        </div>
                        <button type="submit" class="btn btn-primary btn-block btn-lg">Se connecter</button>
                    </form>
                    <div class="auth-footer">Pas encore de compte ? <a href="#" onclick="App.navigate('register');return false">Cr√©er un compte</a></div>
                </div>
            </div>
        </div>

        <!-- REGISTER -->
        <div class="page" id="page-register">
            <div class="auth-page">
                <div class="auth-card">
                    <div class="auth-header">
                        <h1 class="auth-title">Cr√©er un compte</h1>
                        <p class="auth-subtitle">Rejoignez ExcelModel gratuitement</p>
                    </div>
                    <form onsubmit="App.register(event)">
                        <div class="form-group">
                            <label class="form-label">Nom complet</label>
                            <input type="text" class="form-input" id="registerName" required placeholder="Votre nom">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-input" id="registerEmail" required placeholder="votre@email.com">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Mot de passe</label>
                            <input type="password" class="form-input" id="registerPassword" required minlength="6" placeholder="Min. 6 caract√®res">
                        </div>
                        <button type="submit" class="btn btn-primary btn-block btn-lg">Cr√©er mon compte</button>
                    </form>
                    <div class="auth-footer">D√©j√† un compte ? <a href="#" onclick="App.navigate('login');return false">Se connecter</a></div>
                </div>
            </div>
        </div>

        <!-- ADMIN -->
        <div class="page" id="page-admin">
            <section class="section">
                <div class="container">
                    <div class="admin-header">
                        <h2 class="section-title">Administration</h2>
                        <button class="btn btn-primary" onclick="App.openTemplateModal()">+ Nouveau Mod√®le</button>
                    </div>
                    <div class="stats-grid" id="adminStats"></div>
                    <div class="admin-tabs" id="adminTabs">
                        <button class="admin-tab active" data-tab="templates">üìÑ Mod√®les</button>
                        <button class="admin-tab" data-tab="categories">üìÅ Cat√©gories</button>
                    </div>
                    <div id="adminContent"></div>
                </div>
            </section>
        </div>

        <!-- PRICING -->
        <div class="page" id="page-pricing">
            <section class="section">
                <div class="container">
                    <div class="section-header" style="text-align:center">
                        <h2 class="section-title">Choisissez Votre Formule</h2>
                        <p class="section-subtitle">Acc√©dez √† tous nos mod√®les Excel professionnels</p>
                    </div>
                    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:24px;max-width:800px;margin:40px auto 0">
                        <div style="background:var(--white);border:2px solid var(--gray-200);border-radius:var(--radius-xl);padding:40px;text-align:center">
                            <h3 style="font-size:22px;font-weight:700;margin-bottom:8px">Mensuel</h3>
                            <p style="color:var(--gray-600);margin-bottom:24px">Parfait pour tester</p>
                            <div style="font-size:42px;font-weight:800;margin-bottom:24px">9,900 <span style="font-size:16px;font-weight:500;color:var(--gray-500)">FCFA/mois</span></div>
                            <ul style="list-style:none;text-align:left;margin-bottom:32px">
                                <li style="padding:10px 0;display:flex;align-items:center;gap:10px;color:var(--gray-600)"><span style="color:var(--secondary)">‚úì</span> Acc√®s √† tous les mod√®les</li>
                                <li style="padding:10px 0;display:flex;align-items:center;gap:10px;color:var(--gray-600)"><span style="color:var(--secondary)">‚úì</span> T√©l√©chargements illimit√©s</li>
                                <li style="padding:10px 0;display:flex;align-items:center;gap:10px;color:var(--gray-600)"><span style="color:var(--secondary)">‚úì</span> Support par email</li>
                            </ul>
                            <button class="btn btn-outline btn-block btn-lg">Choisir</button>
                        </div>
                        <div style="background:var(--white);border:2px solid var(--primary);border-radius:var(--radius-xl);padding:40px;text-align:center;position:relative">
                            <div style="position:absolute;top:-14px;left:50%;transform:translateX(-50%);background:var(--primary);color:var(--white);padding:6px 20px;border-radius:50px;font-size:13px;font-weight:600">Populaire</div>
                            <h3 style="font-size:22px;font-weight:700;margin-bottom:8px">Annuel</h3>
                            <p style="color:var(--gray-600);margin-bottom:24px">√âconomisez 50%</p>
                            <div style="font-size:42px;font-weight:800;margin-bottom:24px">59,000 <span style="font-size:16px;font-weight:500;color:var(--gray-500)">FCFA/an</span></div>
                            <ul style="list-style:none;text-align:left;margin-bottom:32px">
                                <li style="padding:10px 0;display:flex;align-items:center;gap:10px;color:var(--gray-600)"><span style="color:var(--secondary)">‚úì</span> Tout du plan mensuel</li>
                                <li style="padding:10px 0;display:flex;align-items:center;gap:10px;color:var(--gray-600)"><span style="color:var(--secondary)">‚úì</span> Mod√®les Premium exclusifs</li>
                                <li style="padding:10px 0;display:flex;align-items:center;gap:10px;color:var(--gray-600)"><span style="color:var(--secondary)">‚úì</span> Support WhatsApp prioritaire</li>
                            </ul>
                            <button class="btn btn-primary btn-block btn-lg">Choisir</button>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <div class="logo">
                        <div class="logo-icon">XL</div>
                        <span class="logo-text">Excel<span>Model</span></span>
                    </div>
                    <p class="footer-desc">La premi√®re plateforme de mod√®les Excel professionnels pour les entreprises africaines. Gagnez du temps avec nos templates pr√™ts √† l'emploi.</p>
                </div>
                <div>
                    <h4 class="footer-title">Cat√©gories</h4>
                    <ul class="footer-links">
                        <li><a href="#" onclick="App.filterByCategory('tableaux-de-bord')">Tableaux de bord</a></li>
                        <li><a href="#" onclick="App.filterByCategory('finance-budget')">Finance & Budget</a></li>
                        <li><a href="#" onclick="App.filterByCategory('rh-paie')">RH & Paie</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="footer-title">Entreprise</h4>
                    <ul class="footer-links">
                        <li><a href="#">√Ä propos</a></li>
                        <li><a href="#">Blog</a></li>
                        <li><a href="#">Conditions d'utilisation</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="footer-title">Contact</h4>
                    <ul class="footer-links">
                        <li><a href="https://wa.me/221773684203">üí¨ WhatsApp</a></li>
                        <li><a href="mailto:sawadgsalif@gmail.com">üìß Email</a></li>
                        <li><a href="tel:+221773684203">üì± +221 77 368 42 03</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p class="footer-copy">¬© 2026 ExcelModel. Tous droits r√©serv√©s. | Con√ßu avec ‚ù§Ô∏è au S√©n√©gal</p>
            </div>
        </div>
    </footer>

    <!-- TEMPLATE MODAL -->
    <div class="modal-overlay" id="templateModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title" id="templateModalTitle">Nouveau Mod√®le</h2>
                <button class="modal-close" onclick="App.closeModal('templateModal')">√ó</button>
            </div>
            <div class="modal-body">
                <form id="templateForm" onsubmit="App.saveTemplate(event)">
                    <input type="hidden" id="templateId">
                    <div class="form-group">
                        <label class="form-label">Titre *</label>
                        <input type="text" class="form-input" id="templateTitle" required placeholder="Ex: Dashboard KPI Commercial">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Cat√©gorie *</label>
                        <select class="form-select" id="templateCategoryId" required></select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Description courte</label>
                        <input type="text" class="form-input" id="templateShortDesc" placeholder="Une phrase d√©crivant le mod√®le">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Description compl√®te</label>
                        <textarea class="form-textarea" id="templateDescription" placeholder="Description d√©taill√©e du mod√®le, ses fonctionnalit√©s..."></textarea>
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
                        <div class="form-group">
                            <label class="form-label">Prix (FCFA)</label>
                            <input type="number" class="form-input" id="templatePrice" value="0" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Badge</label>
                            <select class="form-select" id="templateBadge">
                                <option value="">Aucun</option>
                                <option value="new">Nouveau</option>
                                <option value="popular">Populaire</option>
                                <option value="premium">Premium</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Image d'aper√ßu</label>
                        <div class="file-upload" id="imageUploadZone" onclick="document.getElementById('imageFile').click()">
                            <input type="file" id="imageFile" accept="image/*" onchange="App.handleImageSelect(event)">
                            <div class="file-upload-icon">üñºÔ∏è</div>
                            <div class="file-upload-text"><strong>Cliquez</strong> ou glissez une image ici<br><small>PNG, JPG jusqu'√† 5MB</small></div>
                        </div>
                        <div id="imagePreview" style="display:none"></div>
                        <input type="hidden" id="templateImageUrl">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Fichier Excel</label>
                        <div class="file-upload" id="fileUploadZone" onclick="document.getElementById('excelFile').click()">
                            <input type="file" id="excelFile" accept=".xlsx,.xls,.csv" onchange="App.handleFileSelect(event)">
                            <div class="file-upload-icon">üìä</div>
                            <div class="file-upload-text"><strong>Cliquez</strong> ou glissez un fichier Excel<br><small>XLSX, XLS, CSV jusqu'√† 50MB</small></div>
                        </div>
                        <div id="filePreview" style="display:none"></div>
                        <input type="hidden" id="templateFileUrl">
                    </div>
                    <div class="form-group">
                        <label class="form-label">URL Vid√©o YouTube (optionnel)</label>
                        <input type="url" class="form-input" id="templateVideoUrl" placeholder="https://youtube.com/watch?v=...">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Mots-cl√©s</label>
                        <input type="text" class="form-input" id="templateKeywords" placeholder="budget, finance, dashboard (s√©par√©s par virgule)">
                    </div>
                    <div style="display:flex;gap:24px;flex-wrap:wrap">
                        <label class="form-checkbox"><input type="checkbox" id="templateIsFree"> Gratuit</label>
                        <label class="form-checkbox"><input type="checkbox" id="templateIsFeatured"> Mis en avant</label>
                        <label class="form-checkbox"><input type="checkbox" id="templateIsActive" checked> Actif</label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.closeModal('templateModal')">Annuler</button>
                <button class="btn btn-primary" id="saveTemplateBtn" onclick="document.getElementById('templateForm').requestSubmit()">Enregistrer</button>
            </div>
        </div>
    </div>

    <!-- CATEGORY MODAL -->
    <div class="modal-overlay" id="categoryModal">
        <div class="modal" style="max-width:500px">
            <div class="modal-header">
                <h2 class="modal-title" id="categoryModalTitle">Nouvelle Cat√©gorie</h2>
                <button class="modal-close" onclick="App.closeModal('categoryModal')">√ó</button>
            </div>
            <div class="modal-body">
                <form id="categoryForm" onsubmit="App.saveCategory(event)">
                    <input type="hidden" id="categoryId">
                    <div class="form-group">
                        <label class="form-label">Nom *</label>
                        <input type="text" class="form-input" id="categoryName" required placeholder="Ex: Tableaux de Bord">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Ic√¥ne</label>
                        <div class="icon-picker">
                            <button type="button" class="icon-picker-btn" onclick="App.toggleIconPicker()">
                                <span id="selectedIcon">üìÅ</span>
                                <span>Cliquer pour choisir une ic√¥ne</span>
                            </button>
                            <div class="icon-picker-dropdown" id="iconPickerDropdown">
                                <div class="icon-picker-grid" id="iconPickerGrid"></div>
                            </div>
                        </div>
                        <input type="hidden" id="categoryIcon" value="üìÅ">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Description</label>
                        <textarea class="form-textarea" id="categoryDescription" placeholder="Description de la cat√©gorie"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Ordre d'affichage</label>
                        <input type="number" class="form-input" id="categoryOrder" value="0" min="0">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.closeModal('categoryModal')">Annuler</button>
                <button class="btn btn-primary" onclick="document.getElementById('categoryForm').requestSubmit()">Enregistrer</button>
            </div>
        </div>
    </div>

    <!-- CONFIRM MODAL -->
    <div class="modal-overlay" id="confirmModal">
        <div class="modal" style="max-width:420px">
            <div class="modal-header">
                <h2 class="modal-title">Confirmation</h2>
                <button class="modal-close" onclick="App.closeModal('confirmModal')">√ó</button>
            </div>
            <div class="modal-body">
                <p id="confirmMessage" style="font-size:15px;color:var(--gray-700)">√ätes-vous s√ªr de vouloir supprimer cet √©l√©ment ?</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.closeModal('confirmModal')">Annuler</button>
                <button class="btn btn-danger" id="confirmBtn">Supprimer</button>
            </div>
        </div>
    </div>
 { document.getElementById('selectedIcon').textContent = icon; document.getElementById('categoryIcon').value = icon; document.getElementById('iconPickerDropdown').classList.remove('show'); },

    openTemplateModal(t = null) {
        document.getElementById('templateModalTitle').textContent = t ? 'Modifier le Mod√®le' : 'Nouveau Mod√®le';
        document.getElementById('templateId').value = t?.id || '';
        document.getElementById('templateTitle').value = t?.title || '';
        document.getElementById('templateShortDesc').value = t?.short_description || '';
        document.getElementById('templateDescription').value = t?.description || '';
        document.getElementById('templatePrice').value = t?.price || 0;
        document.getElementById('templateBadge').value = t?.badge || '';
        document.getElementById('templateVideoUrl').value = t?.video_url || '';
        document.getElementById('templateKeywords').value = t?.keywords?.join(', ') || '';
        document.getElementById('templateIsFree').checked = t?.is_free || false;
        document.getElementById('templateIsFeatured').checked = t?.is_featured || false;
        document.getElementById('templateIsActive').checked = t?.is_active !== false;
        document.getElementById('templateImageUrl').value = t?.preview_image_url || '';
        document.getElementById('templateFileUrl').value = t?.file_url || '';
        document.getElementById('templateCategoryId').innerHTML = this.categories.map(c => `<option value="${c.id}" ${t?.category_id === c.id ? 'selected' : ''}>${c.icon || 'üìÅ'} ${c.name}</option>`).join('');
        
        this.selectedImageFile = null; this.selectedExcelFile = null;
        document.getElementById('imagePreview').style.display = 'none';
        document.getElementById('filePreview').style.display = 'none';
        document.getElementById('imageUploadZone').style.display = 'block';
        document.getElementById('fileUploadZone').style.display = 'block';
        
        if (t?.preview_image_url) {
            document.getElementById('imagePreview').innerHTML = `<div class="file-preview"><img src="${t.preview_image_url}"><div class="file-preview-info"><div class="file-preview-name">Image actuelle</div></div><button type="button" class="file-preview-remove" onclick="App.removeImage()">√ó</button></div>`;
            document.getElementById('imagePreview').style.display = 'block';
            document.getElementById('imageUploadZone').style.display = 'none';
        }
        if (t?.file_url) {
            document.getElementById('filePreview').innerHTML = `<div class="file-preview"><div style="font-size:36px">üìä</div><div class="file-preview-info"><div class="file-preview-name">Fichier actuel</div></div><button type="button" class="file-preview-remove" onclick="App.removeFile()">√ó</button></div>`;
            document.getElementById('filePreview').style.display = 'block';
            document.getElementById('fileUploadZone').style.display = 'none';
        }
        
        document.getElementById('templateModal').classList.add('active');
    },

    openCategoryModal(c = null) {
        document.getElementById('categoryModalTitle').textContent = c ? 'Modifier la Cat√©gorie' : 'Nouvelle Cat√©gorie';
        document.getElementById('categoryId').value = c?.id || '';
        document.getElementById('categoryName').value = c?.name || '';
        document.getElementById('categoryIcon').value = c?.icon || 'üìÅ';
        document.getElementById('selectedIcon').textContent = c?.icon || 'üìÅ';
        document.getElementById('categoryDescription').value = c?.description || '';
        document.getElementById('categoryOrder').value = c?.display_order || 0;
        document.getElementById('categoryModal').classList.add('active');
    },

    closeModal(id) { document.getElementById(id).classList.remove('active'); },

    confirmDelete(type, id) {
        document.getElementById('confirmMessage').textContent = `√ätes-vous s√ªr de vouloir supprimer ${type === 'template' ? 'ce mod√®le' : 'cette cat√©gorie'} ?`;
        document.getElementById('confirmBtn').onclick = () => { type === 'template' ? this.deleteTemplate(id) : this.deleteCategory(id); this.closeModal('confirmModal'); };
        document.getElementById('confirmModal').classList.add('active');
    },

    // ===== CRUD =====
    async saveTemplate(e) {
        e.preventDefault();
        const btn = document.getElementById('saveTemplateBtn');
        btn.disabled = true; btn.textContent = 'Enregistrement...';
        
        try {
            let imageUrl = document.getElementById('templateImageUrl').value;
            let fileUrl = document.getElementById('templateFileUrl').value;
            
            if (this.selectedImageFile) {
                this.toast('Upload de l\'image...', 'warning');
                imageUrl = await this.uploadFile(this.selectedImageFile, 'images');
            }
            if (this.selectedExcelFile) {
                this.toast('Upload du fichier...', 'warning');
                fileUrl = await this.uploadFile(this.selectedExcelFile, 'templates');
            }
            
            const id = document.getElementById('templateId').value;
            const title = document.getElementById('templateTitle').value;
            const data = {
                title: title,
                category_id: document.getElementById('templateCategoryId').value,
                short_description: document.getElementById('templateShortDesc').value || null,
                description: document.getElementById('templateDescription').value || null,
                price: parseFloat(document.getElementById('templatePrice').value) || 0,
                badge: document.getElementById('templateBadge').value || null,
                preview_image_url: imageUrl || null,
                file_url: fileUrl || null,
                video_url: document.getElementById('templateVideoUrl').value || null,
                keywords: document.getElementById('templateKeywords').value ? document.getElementById('templateKeywords').value.split(',').map(k => k.trim()).filter(k => k) : [],
                is_free: document.getElementById('templateIsFree').checked,
                is_featured: document.getElementById('templateIsFeatured').checked,
                is_active: document.getElementById('templateIsActive').checked
            };
            
            if (!id) {
                data.slug = title.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
            }
            
            const { error } = id ? await this.supabase.from('templates').update(data).eq('id', id) : await this.supabase.from('templates').insert(data);
            if (error) throw error;
            
            await this.loadTemplates();
            this.filteredTemplates = [...this.templates];
            this.closeModal('templateModal');
            this.renderAdmin();
            this.renderFeaturedTemplates();
            document.getElementById('statTemplates').textContent = this.templates.length;
            this.toast('Mod√®le enregistr√© !', 'success');
        } catch (err) {
            console.error(err);
            this.toast('Erreur: ' + err.message, 'error');
        }
        btn.disabled = false; btn.textContent = 'Enregistrer';
    },

    async saveCategory(e) {
        e.preventDefault();
        const id = document.getElementById('categoryId').value;
        const name = document.getElementById('categoryName').value;
        const data = {
            name: name,
            icon: document.getElementById('categoryIcon').value || 'üìÅ',
            description: document.getElementById('categoryDescription').value || null,
            display_order: parseInt(document.getElementById('categoryOrder').value) || 0,
            is_active: true
        };
        if (!id) {
            data.slug = name.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^a-z0-9]+/g, '-');
        }
        try {
            const { error } = id ? await this.supabase.from('categories').update(data).eq('id', id) : await this.supabase.from('categories').insert(data);
            if (error) throw error;
            await this.loadCategories();
            this.closeModal('categoryModal');
            this.renderCategories(); this.renderAdmin();
            this.toast('Cat√©gorie enregistr√©e !', 'success');
        } catch (err) { this.toast('Erreur: ' + err.message, 'error'); }
    },

    editTemplate(id) { this.openTemplateModal(this.templates.find(t => t.id === id)); },
    editCategory(id) { this.openCategoryModal(this.categories.find(c => c.id === id)); },

    async deleteTemplate(id) {
        const { error } = await this.supabase.from('templates').delete().eq('id', id);
        if (!error) { await this.loadTemplates(); this.filteredTemplates = [...this.templates]; this.renderAdmin(); this.renderFeaturedTemplates(); this.toast('Supprim√©', 'success'); }
    },

    async deleteCategory(id) {
        const { error } = await this.supabase.from('categories').delete().eq('id', id);
        if (!error) { await this.loadCategories(); this.renderCategories(); this.renderAdmin(); this.toast('Supprim√©', 'success'); }
    },

    // ===== AUTH =====
    async login(e) {
        e.preventDefault();
        const { error } = await this.supabase.auth.signInWithPassword({ email: document.getElementById('loginEmail').value, password: document.getElementById('loginPassword').value });
        if (error) { this.toast(error.message, 'error'); return; }
        this.toast('Connect√© !', 'success'); this.navigate('home');
    },

    async register(e) {
        e.preventDefault();
        const { error } = await this.supabase.auth.signUp({ email: document.getElementById('registerEmail').value, password: document.getElementById('registerPassword').value, options: { data: { full_name: document.getElementById('registerName').value } } });
        if (error) { this.toast(error.message, 'error'); return; }
        this.toast('Compte cr√©√© ! V√©rifiez votre email.', 'success'); this.navigate('home');
    },

    async logout() { await this.supabase.auth.signOut(); this.navigate('home'); this.toast('D√©connect√©', 'success'); },

    // ===== UTILS =====
    search() {
        const q = document.getElementById('searchInput').value.toLowerCase().trim();
        if (q) {
            this.navigate('templates');
            setTimeout(() => {
                this.filteredTemplates = this.templates.filter(t => 
                    t.title.toLowerCase().includes(q) || 
                    t.short_description?.toLowerCase().includes(q) ||
                    t.category_name?.toLowerCase().includes(q)
                );
                this.currentPage = 1;
                this.renderAllTemplates();
            }, 100);
        }
    },
    searchTag(t) { document.getElementById('searchInput').value = t; this.search(); },
    filter(id) { this.currentFilter = id; this.currentPage = 1; this.filteredTemplates = id === 'all' ? [...this.templates] : this.templates.filter(t => t.category_id === id); this.renderAllTemplates(); },
    filterByCategory(id) { this.navigate('templates'); setTimeout(() => this.filter(id), 100); },
    goToPage(p) { const max = Math.ceil(this.filteredTemplates.length / ITEMS_PER_PAGE); if (p >= 1 && p <= max) { this.currentPage = p; this.renderAllTemplates(); window.scrollTo({ top: 200, behavior: 'smooth' }); } },
    
    download(id) {
        if (!this.user) { this.toast('Connectez-vous pour t√©l√©charger', 'warning'); this.navigate('login'); return; }
        const t = this.templates.find(x => x.id === id);
        if (t?.file_url) { window.open(t.file_url, '_blank'); this.toast('T√©l√©chargement d√©marr√© !', 'success'); }
        else { this.toast('Fichier non disponible', 'error'); }
    },
    
    purchase(id) {
        if (!this.user) { this.toast('Connectez-vous pour acheter', 'warning'); this.navigate('login'); return; }
        this.toast('Contactez-nous sur WhatsApp pour acheter', 'warning');
        window.open('https://wa.me/221773684203', '_blank');
    },

    formatPrice(p) { return new Intl.NumberFormat('fr-FR').format(p || 0) + ' FCFA'; },
    
    toast(msg, type = 'success') {
        const c = document.getElementById('toastContainer');
        const icons = { success: '‚úì', error: '‚úó', warning: '‚ö†' };
        const t = document.createElement('div');
        t.className = 'toast ' + type;
        t.innerHTML = `<span class="toast-icon">${icons[type] || '‚Ä¢'}</span><span class="toast-message">${msg}</span><button class="toast-close" onclick="this.parentElement.remove()">√ó</button>`;
        c.appendChild(t);
        setTimeout(() => t.classList.add('show'), 10);
        setTimeout(() => t.remove(), 4000);
    },
    
    toggleMobileMenu() {
        const l = document.querySelector('.nav-links');
        l.style.display = l.style.display === 'flex' ? 'none' : 'flex';
    }
};

document.addEventListener('DOMContentLoaded', () => App.init());
</script>
</body>
</html>
